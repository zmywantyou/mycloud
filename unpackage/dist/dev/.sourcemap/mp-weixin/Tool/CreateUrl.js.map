{"version":3,"file":"CreateUrl.js","sources":["Tool/CreateUrl.ts"],"sourcesContent":["import{ Base64 } from \"../Tool/Base64\";\r\nexport enum Getype{\r\n\tGettree=\"Gettree\",\r\n\tGetBlob=\"GetBlob\",\r\n\tPostNewFile=\"NewFile\",\r\n\tDelfile=\"Delfile\"\r\n}\r\ninterface fileurlmode{\r\n\taccess_token:string;\r\n\tcontent?:unknown;\r\n\tmessage?:string;\r\n}\r\n\r\nenum ReApi{\r\n\tDelfile=\" https://gitee.com/api/v5/repos/{warehouse}/contents/{path}\",\r\n\tPostnewfile=\"https://gitee.com/api/v5/repos/{warehouse}/contents/{path}\",\r\n\tGettree=\"https://gitee.com/api/v5/repos/{warehouse}/git/trees/{sha}\",\r\n\tGetBlob=\"https://gitee.com/{warehouse}/raw/{sha}/{name}\"\r\n\t//Getfile=\"https://gitee.com/api/v5/repos/cqzmy/hosework/git/trees/{sha}\"\r\n}\r\n\r\nexport class CreateUrl{\r\n\tprivate _Jsonstr:string;\r\n\tprivate _path:string|null=null;\r\n\tprivate _Sha:string=\"master\";\r\n\tprivate _Name:string|null=null;\r\n\tprivate _content:unknown=\".keep\";\r\n\tprivate readonly token:string=\"?access_token=\";\r\n\tprivate readonly Wherepage:string=\"&recursive=1\";\r\n\tprivate readonly prarasha:string=\"&sha=\";\r\n\tprivate readonly mess:string=\"&message=由小程序提交\";\r\n\tpublic constructor(Jsonstr:string){\r\n\t\tthis._Jsonstr=Jsonstr;\r\n\t}\r\n\tpublic AddKey(url:string):string{\r\n\t\treturn url\r\n\t\t+this.token\r\n\t\t+this.FindPara(\"Key\");\r\n\t}\r\n\t\t\r\n\tprivate FindPara(where:string):any{\r\n\t\tlet param:unknown=JSON.parse(this._Jsonstr)[where];\r\n\t\tif(param==undefined){\r\n\t\t\tthrow new Error(\"本地json中无这个值\"+where);\r\n\t\t}\r\n\t\treturn param;\r\n\t}\r\n\tprivate IsupGit(func:string):string{\r\n\t\tif(this.FindPara(\"Isup\") as boolean==false){\r\n\t\t\tthrow new Error(\"git没有开启\");\r\n\t\t}\r\n\t\telse{\r\n\t\t return\tfunc;\r\n\t\t}\r\n\t}\r\n\t//创建文件夹\r\n\tprivate PostNewfile():string{\r\n\t   if(this._path!=null)\r\n\t    var url=ReApi.Postnewfile\r\n\t   .replace(\"{warehouse}\",this.FindPara(\"Warehouse\"))\r\n\t   .replace(\"{path}\",this._path)\r\n\t   else throw new Error(\"path is null\");\r\n\t   return url;\r\n\t}\r\n\tprivate Delfileurl():string{\r\n\t\tif(this._path!=null)\r\n\t\tvar url=ReApi.Delfile\r\n\t\t.replace(\"{warehouse}\",this.FindPara(\"Warehouse\"))\r\n\t\t.replace(\"{path}\",this._path)\r\n\t\telse throw new Error(\"path is null\");\r\n\t\treturn url\r\n\t\t+this.token\r\n\t\t+this.FindPara(\"Key\")\r\n\t\t+this.prarasha\r\n\t\t+this._Sha\r\n\t\t+this.mess;\r\n\t}\r\n\tpublic get postupdatafile(){\r\n\t\tlet fileurlmode:fileurlmode={\r\n\t\t\taccess_token:this.FindPara(\"Key\"),\r\n\t\t}\r\n\t\t//fileurlmode.access_token=this.FindPara(\"Key\");\r\n\t\treturn fileurlmode\r\n\t}\r\n\tpublic set setpostdata(value:unknown){\r\n\t\tthis._content=value;\r\n\t}\r\n\tpublic get postdata() {\r\n\t\tlet fileurlmode:fileurlmode={\r\n\t\t\taccess_token:this.FindPara(\"Key\"),\r\n\t\t\tcontent:this._content,\r\n\t\t\tmessage:\"小程序提交\"\r\n\t\t}\r\n\t\treturn fileurlmode\r\n\t}\r\n\tpublic get Mianfilelist():string{\r\n\t\treturn this.Gettureurl()\r\n\t\t+this.Wherepage;\r\n\t}\r\n\tprivate GetBloburl():string{\r\n\t\tif(this._Name==null||undefined) throw new Error(\"name is null\");\r\n\t\tlet Gettree:string=ReApi.GetBlob\r\n\t\t\t.replace(\"{warehouse}\",this.FindPara(\"Warehouse\"))\r\n\t\t\t.replace(\"{sha}\",this._Sha)\r\n\t\t\t.replace(\"{name}\",this._Name);\r\n\t\t\treturn Gettree\r\n\t\t\t+this.token\r\n\t\t\t+this.FindPara(\"Key\");\r\n\t}\r\n\tprivate Gettureurl():string{\r\n\tlet Gettree:string=ReApi.Gettree\r\n\t\t.replace(\"{warehouse}\",this.FindPara(\"Warehouse\"))\r\n\t\t.replace(\"{sha}\",this._Sha);\r\n\t\treturn Gettree\r\n\t\t+this.token\r\n\t\t+this.FindPara(\"Key\");\r\n\t}\r\n\tpublic SkipPageurl(page:number,url:string):string{\r\n\t\treturn url\r\n\t\t+this.Wherepage\r\n\t\t+page;\r\n\t}\r\n\t\r\n\tpublic set Path(value:string){\r\n\t\tthis._path=value;\r\n\t}\r\n\tpublic set Name(value:string){\r\n\t\tthis._Name=value;\r\n\t}\r\n\tpublic set Sha(value:string){\r\n\t\t//if(value==null) return;\r\n\t\tthis._Sha=value;\r\n\t}\r\n\tpublic Create(getype:string):string{\r\n\t\tswitch(getype){\r\n\t\t\tcase Getype.Delfile:return this.IsupGit(this.Delfileurl());\r\n\t\t\tcase Getype.Gettree:return this.IsupGit(this.Gettureurl());\r\n\t\t\tcase Getype.GetBlob:return this.IsupGit(this.GetBloburl());\r\n\t\t\tcase Getype.PostNewFile:return this.IsupGit(this.PostNewfile());\r\n\t\t\tdefault :throw new Error(\"没有匹配值\") \r\n\t\t}\r\n\t}\r\n}\r\n\r\n"],"names":["Getype"],"mappings":"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"}