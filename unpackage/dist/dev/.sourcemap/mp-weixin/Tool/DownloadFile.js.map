{"version":3,"file":"DownloadFile.js","sources":["Tool/DownloadFile.ts"],"sourcesContent":["\t\r\nclass DownLoandPair{\r\n\tprivate CutePathEnd(path:string):string{\r\n\t\tvar paths= path.split(\".\")\r\n\t\tvar end:string=paths[paths.length-1].toLocaleString();\r\n\t\t//console.log(end);\r\n\t\tif(end!=null)\r\n\t\treturn end;\r\n\t\telse throw Error(\"end is null\");\r\n\t\t\r\n\t}\r\n\tpublic ShowToastfilepath(path:any){\r\n\t\tuni.showToast({\r\n\t\t icon: 'none',\r\n\t\t mask: true,\r\n\t\t title: '文件已保存：' + path, //保存路径\r\n\t\t duration: 3000,\r\n\t\t\t\t});\r\n\t}\r\n\tpublic setTimeout(path:any){\r\n\t\tconst name=this.CutePathEnd(path);\r\n\t\tconsole.log(name);\r\n\t setTimeout(() => {\r\n\t\tuni.openDocument({\r\n\t\tfilePath: path,\r\n\t\t showMenu: true,\r\n\t\tfileType:name\r\n\t\t\t});\r\n\t\t\t})\r\n\t}\r\n}\r\n\r\n\r\nexport class DownloandFile{\r\n\r\nprivate DownFile(url:string,name:string){\r\n\t\r\n\tuni.downloadFile({\r\n\t url:url,\r\n\t fail: (err) => {\r\n\t    console.log('downloadFile fail, err is:', err)\r\n\t    },\r\n\t success:function(res){\r\n\t\t //console.log(url);\r\n\t\tif(res.statusCode==200){\r\n\t    const fs = uni.getFileSystemManager();\r\n\t\t const savedFilePath = `${wx.env.USER_DATA_PATH}/${name}`;\r\n\t\tfs.saveFile({\r\n\t\ttempFilePath:res.tempFilePath,\r\n\t\t filePath: savedFilePath,\r\n\t\tfail(err) {\r\n\t\t\t  console.log('saveFile fail, err is:', err)\r\n\t\t},\r\n\t\tsuccess:function(data){\r\n\t\tconsole.log(data.savedFilePath)\r\n\t\t new DownLoandPair().ShowToastfilepath(savedFilePath);\r\n\t     new DownLoandPair().setTimeout(savedFilePath);\r\n\t\t\t}})}}\r\n})\r\n\r\n\t\r\n}\r\n  public constructor(url :string,name:string){\r\n\t   console.log(url)\r\n\t  this.DownFile(url,name);\r\n\t }\r\n}"],"names":["uni","wx"],"mappings":";;AACA,MAAM,cAAa;AAAA,EACV,YAAY,MAAmB;AAClC,QAAA,QAAO,KAAK,MAAM,GAAG;AACzB,QAAI,MAAW,MAAM,MAAM,SAAO,CAAC,EAAE;AAErC,QAAG,OAAK;AACD,aAAA;AAAA;AACF,YAAM,MAAM,aAAa;AAAA,EAE/B;AAAA,EACO,kBAAkB,MAAS;AACjCA,kBAAAA,MAAI,UAAU;AAAA,MACb,MAAM;AAAA,MACN,MAAM;AAAA,MACN,OAAO,WAAW;AAAA;AAAA,MAClB,UAAU;AAAA,IAAA,CACR;AAAA,EACJ;AAAA,EACO,WAAW,MAAS;AACpB,UAAA,OAAK,KAAK,YAAY,IAAI;mEACpB,IAAI;AAChB,eAAW,MAAM;AACjBA,oBAAAA,MAAI,aAAa;AAAA,QACjB,UAAU;AAAA,QACT,UAAU;AAAA,QACX,UAAS;AAAA,MAAA,CACP;AAAA,IAAA,CACA;AAAA,EACH;AACD;AAGO,MAAM,cAAa;AAAA,EAElB,SAAS,KAAW,MAAY;AAEvCA,kBAAAA,MAAI,aAAa;AAAA,MAChB;AAAA,MACA,MAAM,CAAC,QAAQ;AACZA,sBAAA,MAAA,MAAA,OAAA,8BAAY,8BAA8B,GAAG;AAAA,MAC7C;AAAA,MACH,SAAQ,SAAS,KAAI;AAElB,YAAA,IAAI,cAAY,KAAI;AACd,gBAAA,KAAKA,oBAAI;AACjB,gBAAM,gBAAgB,GAAGC,mBAAG,IAAI,cAAc,IAAI,IAAI;AACvD,aAAG,SAAS;AAAA,YACZ,cAAa,IAAI;AAAA,YAChB,UAAU;AAAA,YACX,KAAK,KAAK;AACPD,4BAAA,iDAAY,0BAA0B,GAAG;AAAA,YAC5C;AAAA,YACA,SAAQ,SAAS,MAAK;AACtBA,4BAAA,iDAAY,KAAK,aAAa;AACzB,kBAAA,cAAgB,EAAA,kBAAkB,aAAa;AAC5C,kBAAA,cAAgB,EAAA,WAAW,aAAa;AAAA,YAC/C;AAAA,UAAA,CAAE;AAAA,QAAC;AAAA,MAAC;AAAA,IAAA,CACN;AAAA,EAGD;AAAA,EACS,YAAY,KAAY,MAAY;AACzCA,kBAAAA,MAAA,MAAA,OAAA,8BAAY,GAAG;AACX,SAAA,SAAS,KAAI,IAAI;AAAA,EACvB;AACF;;"}